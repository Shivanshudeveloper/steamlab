(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[49],{6126:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/stlfiles",function(){return n(5607)}])},5607:function(e,t,n){"use strict";n.r(t);var r=n(8520),i=n.n(r),o=n(5893),a=n(9008),c=n(7948),l=(n(2873),n(2379),n(3536)),s=(n(5102),n(7294)),u=n(7906),d=n(295),h=n(3252),f=n(2882),p=n(3184),x=n(3816),g=n(5113),m=n(1057),j=n(9586),v=n(657),y=n(1425),Z=n(6580),b=n(7645),S=n(2474),w=n(5162),_=n(9058),C=n(9123),F=n(7918),D=n(8456),k=n(9669),E=n.n(k),O=n(7035),T=n(8977);function P(e,t,n,r,i,o,a){try{var c=e[o](a),l=c.value}catch(s){return void n(s)}c.done?t(l):Promise.resolve(l).then(r,i)}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){I(e,t,n[t])}))}return e}function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){i=!0,o=l}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function N(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var W=function(e){var t=e.product,n=e.deleteItem;return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(x.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,o.jsx)(h.Z,{component:"th",scope:"row",children:t.name}),(0,o.jsx)(h.Z,{align:"center",children:t.cut}),(0,o.jsx)(h.Z,{align:"center",children:t.content}),(0,o.jsx)(h.Z,{align:"center",children:t.uploaded_to}),(0,o.jsx)(h.Z,{align:"center",children:(0,o.jsx)(F.Z,{sx:{backgroundColor:"blue",color:"#FFFFFF"},label:t.status})}),(0,o.jsx)(h.Z,{align:"center",children:t.reception}),(0,o.jsx)(h.Z,{align:"center",children:t.delivery_date}),(0,o.jsxs)(h.Z,{align:"center",children:[(0,o.jsx)(m.Z,{variant:"contained",href:t.publicURL,target:"_blank",children:"Download"}),(0,o.jsx)(m.Z,{color:"error",onClick:function(){return n(t._id)},sx:{ml:2},children:"Delete"})]})]},t._id)})},R=function(){var e=(0,w.uI)(),t=e.acceptedFiles,n=e.getRootProps,r=e.getInputProps,l=A(s.useState([]),2),F=l[0],k=l[1],I=A(s.useState(!1),2),R=I[0],z=I[1],U=A(s.useState({}),2),q=U[0],V=U[1],M=A(s.useState(!0),2),X=M[0],B=M[1];s.useEffect((function(){var e=sessionStorage.getItem("userEmail");O.I8.onAuthStateChanged((function(e){e&&V(e)})),E().get("".concat(T.V,"/api/v1/main/getuserfileuploadedtoserver/").concat(e)).then((function(e){k(e.data),B(!1)})).catch((function(e){return console.log(e)}))}),[]);var G=function(){var e=sessionStorage.getItem("userEmail");B(!0),E().get("".concat(T.V,"/api/v1/main/getuserfileuploadedtoserver/").concat(e)).then((function(e){k(e.data),B(!1)})).catch((function(e){return console.log(e)}))},H=A(s.useState((new Date).toLocaleDateString()),2),J=H[0],K=H[1],Q=function(){z(!1)},Y=t.map((function(e){return(0,o.jsxs)("li",{children:[e.path," - ",e.size," bytes"]},e.path)})),$=A(s.useState(""),2),ee=$[0],te=$[1],ne=A(s.useState([]),2),re=ne[0],ie=ne[1],oe=A(s.useState(!1),2),ae=oe[0],ce=oe[1],le=A(s.useState(""),2),se=le[0],ue=le[1],de=A(s.useState(""),2),he=de[0],fe=de[1],pe=function(){t.forEach((function(e){var t,n=(0,_.Z)(),r=O.tO.ref("uploadsfiles/".concat(n,"/").concat(e.name)).put(e);r.on("state_changed",(function(e){var t=Math.round(e.bytesTransferred/e.totalBytes*100);ce(!0),ue("Uploaded ".concat(Math.floor(t),"%"))}),(function(e){ue(e)}),(t=i().mark((function t(){var n,o,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(0,C.Z)(e.size),n="".concat(n.value," ").concat(n.unit),t.next=4,r.snapshot.ref.getDownloadURL();case 4:o=t.sent,a={useremail:q.email,userfullname:q.displayName,userphone:he,name:e.path,cut:n,content:e.type,uploaded_to:(new Date).toLocaleDateString(),status:"Received",reception:ee,delivery_date:J,publicURL:o},E().post("".concat(T.V,"/api/v1/main/addfileuploadtoserver"),a).then((function(e){200===e.status&&(ce(!0),ue("File Successfully Send"),G(),setInterval((function(){ce(!1)}),4e3))})).catch((function(e){return console.log(e)}));case 7:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(e){P(o,r,i,a,c,"next",e)}function c(e){P(o,r,i,a,c,"throw",e)}a(void 0)}))}))}))},xe=function(e){E().get("".concat(T.V,"/api/v1/main/deletefileuploadtouser/").concat(e)).then((function(e){ce(!0),ue("Successfully Removed"),G(),Q()})).catch((function(e){return console.log(e)}))};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(j.Z,{open:ae,autoHideDuration:6e3,message:se,onClose:function(){ce(!1)}}),(0,o.jsxs)(v.Z,{open:R,fullWidth:!0,maxWidth:"md",onClose:Q,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,o.jsx)(b.Z,{id:"alert-dialog-title",children:"STL File Upload"}),(0,o.jsx)(Z.Z,{children:(0,o.jsxs)(c.Z,{children:[(0,o.jsxs)("section",L({className:"dropzone"},n(),{children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("input",L({},r())),(0,o.jsx)("p",{children:"Drag 'n' drop some files here, or click to select files"})]}),(0,o.jsxs)("aside",{children:[(0,o.jsx)("h4",{children:"Files"}),(0,o.jsx)("ul",{children:Y})]})]})),(0,o.jsx)(S.Z,{id:"outlined-multiline-static",fullWidth:!0,label:"When do you need it?",multiline:!0,rows:6,sx:{mt:2},value:ee,onChange:function(e){te(e.target.value)}}),(0,o.jsx)("h4",{style:{marginTop:"1rem"},children:"When do you need it?"}),(0,o.jsx)(S.Z,{required:!0,id:"outlined-required",type:"date",fullWidth:!0,sx:{mt:2},onChange:function(e){K(e.target.value)}}),(0,o.jsx)(S.Z,{required:!0,label:"Phone Number",id:"outlined-required",fullWidth:!0,sx:{mt:2},onChange:function(e){return fe(e.target.value)}})]})}),(0,o.jsxs)(y.Z,{children:[(0,o.jsx)(m.Z,{size:"large",onClick:Q,children:"Close"}),(0,o.jsx)(m.Z,{size:"large",onClick:function(){pe();var e=N(re);for(t.forEach((function(t){var n,r,i,o,a=(0,C.Z)(t.size);a="".concat(a.value," ").concat(a.unit),e.push((n=t.path,r=a,i=t.type,o=(new Date).toLocaleDateString(),{name:n,cut:r,contentType:i,uploadedTo:o,status:"Received",desiredReception:ee,date:J}))})),ie(e);t.length>0;)t.pop();te(""),Q()},autoFocus:!0,children:"Submit"})]})]}),(0,o.jsx)(a.default,{children:(0,o.jsx)("title",{children:"STL Files Upload"})}),(0,o.jsxs)(c.Z,{maxWidth:"xl",component:"main",sx:{flexGrow:1,py:8},children:[(0,o.jsx)(m.Z,{sx:{float:"right",mb:8},onClick:function(){z(!0)},variant:"contained",size:"large",children:"Submit a STL File"}),(0,o.jsx)("h1",{style:{marginTop:"45px"},children:"Shipment history"}),!0===X?(0,o.jsx)("center",{style:{marginTop:"8%"},children:(0,o.jsx)(D.Z,{color:"primary"})}):(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(f.Z,{component:g.Z,children:(0,o.jsxs)(u.Z,{sx:{minWidth:650},"aria-label":"simple table",children:[(0,o.jsx)(p.Z,{children:(0,o.jsxs)(x.Z,{children:[(0,o.jsx)(h.Z,{children:"Name"}),(0,o.jsx)(h.Z,{align:"center",children:"Cut"}),(0,o.jsx)(h.Z,{align:"center",children:"Content type"}),(0,o.jsx)(h.Z,{align:"center",children:"Uploaded to"}),(0,o.jsx)(h.Z,{align:"center",children:"Status"}),(0,o.jsx)(h.Z,{align:"center",children:"Desired reception"}),(0,o.jsx)(h.Z,{align:"center",children:"Delivery date"}),(0,o.jsx)(h.Z,{align:"center",children:"Action"})]})}),(0,o.jsx)(d.Z,{children:F.map((function(e){return(0,o.jsx)(W,{product:e,deleteItem:xe},e._id)}))})]})})})]})]})};R.getLayout=function(e){return(0,o.jsx)(l.c,{children:e})},t.default=R}},function(e){e.O(0,[883,775,239,63,650,474,878,271,538,546,536,923,774,888,179],(function(){return t=6126,e(e.s=t);var t}));var t=e.O();_N_E=t}]);